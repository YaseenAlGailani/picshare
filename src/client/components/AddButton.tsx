import { PointerEvent, useState, KeyboardEvent } from "react";

interface Props {
  initialAdded?: boolean;
  add: () => void;
  remove: () => void;
}

export default function AddButton({
  initialAdded = false,
  add,
  remove,
}: Props) {
  const [added, setAdded] = useState(initialAdded);

  const handleButtonClick = (event: PointerEvent<HTMLButtonElement>) => {
    event.stopPropagation();
    setAdded(!added);
    updateFavourite();
  };

  const handleButtonKeyDown = (event: KeyboardEvent<HTMLButtonElement>) => {
    if (
      event.code === "Space" ||
      event.code === "Enter" ||
      event.code === "NumpadEnter"
    ) {
      event.stopPropagation();
      event.preventDefault();
      setAdded(!added);
      updateFavourite();
    }
  };

  const updateFavourite = () => {
    if (added) {
      remove();
      return;
    }
    add();
  };

  return (
    <button
      onClick={handleButtonClick}
      onKeyDown={handleButtonKeyDown}
      className="w-6 h-6 flex items-center justify-center"
    >
      <span className="sr-only">Add to favourites</span>
      {added ? (
        <svg
          width="17"
          height="16"
          viewBox="0 0 17 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M16.5273 3.53893C16.2655 2.93275 15.8881 2.38344 15.416 1.92174C14.9436 1.45867 14.3866 1.09067 13.7754 0.837759C13.1416 0.574465 12.4617 0.439695 11.7754 0.441275C10.8125 0.441275 9.87305 0.704947 9.05664 1.20299C8.86133 1.32213 8.67578 1.45299 8.5 1.59557C8.32422 1.45299 8.13867 1.32213 7.94336 1.20299C7.12695 0.704947 6.1875 0.441275 5.22461 0.441275C4.53125 0.441275 3.85938 0.574088 3.22461 0.837759C2.61133 1.09167 2.05859 1.4569 1.58398 1.92174C1.11132 2.38292 0.733746 2.93236 0.472656 3.53893C0.201172 4.16979 0.0625 4.83971 0.0625 5.52917C0.0625 6.17956 0.195313 6.85729 0.458984 7.54674C0.679688 8.12292 0.996094 8.72057 1.40039 9.32409C2.04102 10.2792 2.92188 11.2753 4.01562 12.285C5.82812 13.9589 7.62305 15.1151 7.69922 15.162L8.16211 15.4589C8.36719 15.5897 8.63086 15.5897 8.83594 15.4589L9.29883 15.162C9.375 15.1132 11.168 13.9589 12.9824 12.285C14.0762 11.2753 14.957 10.2792 15.5977 9.32409C16.002 8.72057 16.3203 8.12292 16.5391 7.54674C16.8027 6.85729 16.9355 6.17956 16.9355 5.52917C16.9375 4.83971 16.7988 4.16979 16.5273 3.53893Z"
            fill="#FF4D4F"
          />
        </svg>
      ) : (
        <svg
          width="21"
          height="18"
          viewBox="0 0 21 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M19.6746 3.89773C19.3754 3.20496 18.944 2.57717 18.4045 2.04952C17.8646 1.52029 17.2281 1.09972 16.5295 0.810677C15.8051 0.509769 15.0282 0.355747 14.2438 0.357552C13.1434 0.357552 12.0697 0.658891 11.1367 1.22809C10.9135 1.36425 10.7014 1.5138 10.5005 1.67675C10.2996 1.5138 10.0876 1.36425 9.86435 1.22809C8.93131 0.658891 7.85765 0.357552 6.7572 0.357552C5.96479 0.357552 5.19694 0.509338 4.47149 0.810677C3.7706 1.10086 3.1389 1.51827 2.59649 2.04952C2.0563 2.57657 1.62479 3.20451 1.3264 3.89773C1.01613 4.61871 0.857651 5.38434 0.857651 6.17228C0.857651 6.91559 1.00944 7.69014 1.31078 8.47809C1.56301 9.13657 1.92462 9.81961 2.38667 10.5093C3.11881 11.6009 4.12551 12.7392 5.37551 13.8933C7.44694 15.8062 9.49828 17.1276 9.58533 17.1812L10.1143 17.5205C10.3487 17.6701 10.6501 17.6701 10.8844 17.5205L11.4135 17.1812C11.5005 17.1254 13.5496 15.8062 15.6233 13.8933C16.8733 12.7392 17.88 11.6009 18.6121 10.5093C19.0742 9.81961 19.438 9.13657 19.688 8.47809C19.9893 7.69014 20.1411 6.91559 20.1411 6.17228C20.1434 5.38434 19.9849 4.61871 19.6746 3.89773V3.89773ZM10.5005 15.7549C10.5005 15.7549 2.55408 10.6634 2.55408 6.17228C2.55408 3.89773 4.43578 2.05398 6.7572 2.05398C8.3889 2.05398 9.80408 2.96469 10.5005 4.29505C11.1969 2.96469 12.6121 2.05398 14.2438 2.05398C16.5652 2.05398 18.4469 3.89773 18.4469 6.17228C18.4469 10.6634 10.5005 15.7549 10.5005 15.7549Z"
            fill="black"
            fillOpacity="0.85"
          />
        </svg>
      )}
    </button>
  );
}
